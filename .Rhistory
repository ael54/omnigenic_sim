setwd("/Users/alipka/Library/CloudStorage/Box-Box/Sabbatical_Roslin_Institute/R_workspace/Sabbatical_Project")
home.dir <- getwd()
#####Read in all of the packages that are necessary
#Read in prerequiste libaries for GAPIT
library('MASS')
library(gplots)
library(sommer)
#######################################################
### Results for the core QTL
#######################################################
these.spearman.rank.correlation.between.GWAS.core.QTNs <- readRDS("/Users/alipka/Library/CloudStorage/Box-Box/IR-281/Master-Result-Lists-2024-06-13/master.these.spearman.rank.correlation.between.GWAS.core.QTNs.RDS")
str(these.spearman.rank.correlation.between.GWAS.core.QTNs)
head(names(these.spearman.rank.correlation.between.GWAS.core.QTNs))
these.spearman.rank.correlation.between.GWAS.core.QTNs[1]
#Experimental code
factor.A <- 1
factor.B <- 0.05
factor.C <- 0.05
factor.D <- 0.05
rep <- 1
this.setting <-  paste(factor.A,".FactorA..",factor.B, ".FactorB..",
factor.C,".FactorC..",factor.D,".FactorD..",
this.rep, ".Rep", sep = "")
factor.A <- 1
factor.B <- 0.05
factor.C <- 0.05
factor.D <- 0.05
this.rep <- 1
this.setting <-  paste(factor.A,".FactorA..",factor.B, ".FactorB..",
factor.C,".FactorC..",factor.D,".FactorD..",
this.rep, ".Rep", sep = "")
this.setting <-  paste(factor.A,".FactorA..",factor.B, ".FactorB..",
factor.C,".FactorC..",factor.D,".FactorD..",
this.rep, ".Rep", sep = "")
results.this.setting <- these.spearman.rank.correlation.between.GWAS.core.QTNs[which(names(these.spearman.rank.correlation.between.GWAS.core.QTNs)
== this.setting)]
results.this.setting
this.rep <- 2
this.setting <-  paste(factor.A,".FactorA..",factor.B, ".FactorB..",
factor.C,".FactorC..",factor.D,".FactorD..",
this.rep, ".Rep", sep = "")
results.this.setting <- these.spearman.rank.correlation.between.GWAS.core.QTNs[which(names(these.spearman.rank.correlation.between.GWAS.core.QTNs)
== this.setting)]
results.this.setting
dim(results.this.setting)
dim(results.this.setting$this.setting)
dim(results.this.setting$1.FactorA..0.05.FactorB..0.05.FactorC..0.05.FactorD..2.Rep)
dim(results.this.setting$1.FactorA..0.05.FactorB..0.05.FactorC..0.05.FactorD..2.Rep)
dim(results.this.setting$paste(1.FactorA..0.05.FactorB..0.05.FactorC..0.05.FactorD..2.Rep))
unlist(results.this.setting)
as.matrix(unlist(results.this.setting), nrow = 3)
results.this.setting
as.matrix(unlist(t(results.this.setting)), nrow = 3)
matrix(unlist(t(results.this.setting)), nrow = 3)
matrix(unlist(results.this.setting), nrow = 3)
#Extract the results we want
results.this.setting <- these.spearman.rank.correlation.between.GWAS.core.QTNs[which(names(these.spearman.rank.correlation.between.GWAS.core.QTNs))]
this.setting
#Extract the results we want
results.this.setting <- these.spearman.rank.correlation.between.GWAS.core.QTNs[which(names(these.spearman.rank.correlation.between.GWAS.core.QTNs)
== this.setting)]
#Put the results into a format that we can extract the numbers from                                                                                                                                                                        == this.setting)]
matrix(unlist(results.this.setting), nrow = 3)
#Put the results into a format that we can extract the numbers from                                                                                                                                                                        == this.setting)]
results.this.setting.for.figure <- matrix(unlist(results.this.setting), nrow = 3)
results.this.setting for figure
results.this.setting.for.figure
spearman.rank.vector <- NA
factor.A.vector <- NA
factor.B.vector <- NA
factor.C.vector <- NA
factor.D.vector <- NA
rep.vector <- NA
pop.A.vector <- NA
pop.B.vector <- NA
i <- 1
j <- 0.05
k <- 0.05
el <- 0.05
rep <- 1
#Run the function
factor.A <- i
factor.B <- j
factor.C <- k
factor.D <- el
this.rep <- rep
#Get the object from the list you want
factor.A <- i
factor.B <- j
factor.C <- k
factor.D <- el
this.rep <- rep
#Read in the R data file for a given setting
this.setting <-  paste(factor.A,".FactorA..",factor.B, ".FactorB..",
factor.C,".FactorC..",factor.D,".FactorD..",
this.rep, ".Rep", sep = "")
#Extract the results we want
results.this.setting <- these.spearman.rank.correlation.between.GWAS.core.QTNs[which(names(these.spearman.rank.correlation.between.GWAS.core.QTNs)
== this.setting)]
#Put the results into a format that we can extract the numbers from                                                                                                                                                                        == this.setting)]
results.this.setting.for.figure <- matrix(unlist(results.this.setting), nrow = 3)
1:nrow(results.this.setting.for.figure)
#Get the object from the list you want
factor.A <- i
factor.B <- j
factor.C <- k
factor.D <- el
this.rep <- rep
#Read in the R data file for a given setting
this.setting <-  paste(factor.A,".FactorA..",factor.B, ".FactorB..",
factor.C,".FactorC..",factor.D,".FactorD..",
this.rep, ".Rep", sep = "")
#Extract the results we want
results.this.setting <- these.spearman.rank.correlation.between.GWAS.core.QTNs[which(names(these.spearman.rank.correlation.between.GWAS.core.QTNs)
== this.setting)]
#Put the results into a format that we can extract the numbers from                                                                                                                                                                        == this.setting)]
results.this.setting.for.figure <- matrix(unlist(results.this.setting), nrow = 3)
results.this.setting.for.figure
this.row <- 1
i <- 1
j <- 0.05
k <- 0.05
el <- 0.05
rep <- 1
spearman.rank.vector <- NA
factor.A.vector <- NA
factor.B.vector <- NA
factor.C.vector <- NA
factor.D.vector <- NA
rep.vector <- NA
pop.A.vector <- NA
pop.B.vector <- NA
#Get the object from the list you want
factor.A <- i
factor.B <- j
factor.C <- k
factor.D <- el
this.rep <- rep
#Read in the R data file for a given setting
this.setting <-  paste(factor.A,".FactorA..",factor.B, ".FactorB..",
factor.C,".FactorC..",factor.D,".FactorD..",
this.rep, ".Rep", sep = "")
#Extract the results we want
results.this.setting <- these.spearman.rank.correlation.between.GWAS.core.QTNs[which(names(these.spearman.rank.correlation.between.GWAS.core.QTNs)
== this.setting)]
#Put the results into a format that we can extract the numbers from                                                                                                                                                                        == this.setting)]
results.this.setting.for.figure <- matrix(unlist(results.this.setting), nrow = 3)
#Loop through the pairs of populations, and extract the information we need
for(this.row in 1:nrow(results.this.setting.for.figure)){
spearman.rank.vector <- c(spearman.rank.vector, results.this.setting.for.figure[this.row,3])
factor.A.vector <- c(factor.A.vector, factor.A)
factor.B.vector <- c(factor.B.vector, factor.B)
factor.C.vector <- c(factor.C.vector, factor.C)
factor.D.vector <- c(factor.D.vector, factor.D)
rep.vector <- c(rep.vector, this.rep)
pop.A.vector <-c(pop.A.vector, results.this.setting.for.figure[this.row,1])
pop.B.vector <- c(pop.B.vector, results.this.setting.for.figure[this.row,2])
}#End for(this.row in 1:nrow(results.this.setting.for.figure))
spearman.rank.vector
factor.A.vector
data.for.boxplot <- data.frame(spearman.rank.vector, factor.A.vector,
factor.B.vector, factor.C.vector,
factor.D.vector, rep.vector,
pop.A.vector, pop.B.vector)
data.for.boxplot
spearman.rank.vector <- NULL
factor.A.vector <- NULL
factor.B.vector <- NULL
factor.C.vector <- NULL
factor.D.vector <- NULL
rep.vector <- NULL
pop.A.vector <- NULL
pop.B.vector <- NULL
#Get the object from the list you want
factor.A <- i
factor.B <- j
factor.C <- k
factor.D <- el
this.rep <- rep
#Read in the R data file for a given setting
this.setting <-  paste(factor.A,".FactorA..",factor.B, ".FactorB..",
factor.C,".FactorC..",factor.D,".FactorD..",
this.rep, ".Rep", sep = "")
#Extract the results we want
results.this.setting <- these.spearman.rank.correlation.between.GWAS.core.QTNs[which(names(these.spearman.rank.correlation.between.GWAS.core.QTNs)
== this.setting)]
#Put the results into a format that we can extract the numbers from                                                                                                                                                                        == this.setting)]
results.this.setting.for.figure <- matrix(unlist(results.this.setting), nrow = 3)
#Loop through the pairs of populations, and extract the information we need
for(this.row in 1:nrow(results.this.setting.for.figure)){
spearman.rank.vector <- c(spearman.rank.vector, results.this.setting.for.figure[this.row,3])
factor.A.vector <- c(factor.A.vector, factor.A)
factor.B.vector <- c(factor.B.vector, factor.B)
factor.C.vector <- c(factor.C.vector, factor.C)
factor.D.vector <- c(factor.D.vector, factor.D)
rep.vector <- c(rep.vector, this.rep)
pop.A.vector <-c(pop.A.vector, results.this.setting.for.figure[this.row,1])
pop.B.vector <- c(pop.B.vector, results.this.setting.for.figure[this.row,2])
}#End for(this.row in 1:nrow(results.this.setting.for.figure))
spearman.rank.vector <- NULL
factor.A.vector <- NULL
factor.B.vector <- NULL
factor.C.vector <- NULL
factor.D.vector <- NULL
rep.vector <- NULL
pop.A.vector <- NULL
pop.B.vector <- NULL
i <- 1
j <- 0.05
k <- 0.05
el <- 0.05
rep <- 1
spearman.rank.vector <- NULL
factor.A.vector <- NULL
factor.B.vector <- NULL
factor.C.vector <- NULL
factor.D.vector <- NULL
rep.vector <- NULL
pop.A.vector <- NULL
pop.B.vector <- NULL
#Get the object from the list you want
factor.A <- i
factor.B <- j
factor.C <- k
factor.D <- el
this.rep <- rep
#Read in the R data file for a given setting
this.setting <-  paste(factor.A,".FactorA..",factor.B, ".FactorB..",
factor.C,".FactorC..",factor.D,".FactorD..",
this.rep, ".Rep", sep = "")
#Extract the results we want
results.this.setting <- these.spearman.rank.correlation.between.GWAS.core.QTNs[which(names(these.spearman.rank.correlation.between.GWAS.core.QTNs)
== this.setting)]
#Put the results into a format that we can extract the numbers from                                                                                                                                                                        == this.setting)]
results.this.setting.for.figure <- matrix(unlist(results.this.setting), nrow = 3)
#Loop through the pairs of populations, and extract the information we need
for(this.row in 1:nrow(results.this.setting.for.figure)){
spearman.rank.vector <- c(spearman.rank.vector, results.this.setting.for.figure[this.row,3])
factor.A.vector <- c(factor.A.vector, factor.A)
factor.B.vector <- c(factor.B.vector, factor.B)
factor.C.vector <- c(factor.C.vector, factor.C)
factor.D.vector <- c(factor.D.vector, factor.D)
rep.vector <- c(rep.vector, this.rep)
pop.A.vector <-c(pop.A.vector, results.this.setting.for.figure[this.row,1])
pop.B.vector <- c(pop.B.vector, results.this.setting.for.figure[this.row,2])
}#End for(this.row in 1:nrow(results.this.setting.for.figure))
data.for.boxplot <- data.frame(spearman.rank.vector, factor.A.vector,
factor.B.vector, factor.C.vector,
factor.D.vector, rep.vector,
pop.A.vector, pop.B.vector)
View(data.for.boxplot)
results.this.setting.for.figure
i <- 1
j <- 0.05
k <- 0.05
el <- 0.05
spearman.rank.vector <- NULL
factor.A.vector <- NULL
factor.B.vector <- NULL
factor.C.vector <- NULL
factor.D.vector <- NULL
rep.vector <- NULL
pop.A.vector <- NULL
pop.B.vector <- NULL
for(rep in 1:3){
#Get the object from the list you want
factor.A <- i
factor.B <- j
factor.C <- k
factor.D <- el
this.rep <- rep
#Read in the R data file for a given setting
this.setting <-  paste(factor.A,".FactorA..",factor.B, ".FactorB..",
factor.C,".FactorC..",factor.D,".FactorD..",
this.rep, ".Rep", sep = "")
#Extract the results we want
results.this.setting <- these.spearman.rank.correlation.between.GWAS.core.QTNs[which(names(these.spearman.rank.correlation.between.GWAS.core.QTNs)
== this.setting)]
#Put the results into a format that we can extract the numbers from                                                                                                                                                                        == this.setting)]
results.this.setting.for.figure <- matrix(unlist(results.this.setting), nrow = 3)
#Loop through the pairs of populations, and extract the information we need
for(this.row in 1:nrow(results.this.setting.for.figure)){
spearman.rank.vector <- c(spearman.rank.vector, results.this.setting.for.figure[this.row,3])
factor.A.vector <- c(factor.A.vector, factor.A)
factor.B.vector <- c(factor.B.vector, factor.B)
factor.C.vector <- c(factor.C.vector, factor.C)
factor.D.vector <- c(factor.D.vector, factor.D)
rep.vector <- c(rep.vector, this.rep)
pop.A.vector <-c(pop.A.vector, results.this.setting.for.figure[this.row,1])
pop.B.vector <- c(pop.B.vector, results.this.setting.for.figure[this.row,2])
}#End for(this.row in 1:nrow(results.this.setting.for.figure))
}#End for(rep in 1:3)
data.for.boxplot <- data.frame(spearman.rank.vector, factor.A.vector,
factor.B.vector, factor.C.vector,
factor.D.vector, rep.vector,
pop.A.vector, pop.B.vector)
View(data.for.boxplot)
i <- 1
j <- 0.05
k <- 0.05
#Extract all of the results and put them into an object
spearman.rank.vector <- NULL
factor.A.vector <- NULL
factor.B.vector <- NULL
factor.C.vector <- NULL
factor.D.vector <- NULL
rep.vector <- NULL
pop.A.vector <- NULL
pop.B.vector <- NULL
for(el in c(0.05,0.5,1,2)){
for(rep in 1:3){
#Get the object from the list you want
factor.A <- i
factor.B <- j
factor.C <- k
factor.D <- el
this.rep <- rep
#Read in the R data file for a given setting
this.setting <-  paste(factor.A,".FactorA..",factor.B, ".FactorB..",
factor.C,".FactorC..",factor.D,".FactorD..",
this.rep, ".Rep", sep = "")
#Extract the results we want
results.this.setting <- these.spearman.rank.correlation.between.GWAS.core.QTNs[which(names(these.spearman.rank.correlation.between.GWAS.core.QTNs)
== this.setting)]
#Put the results into a format that we can extract the numbers from                                                                                                                                                                        == this.setting)]
results.this.setting.for.figure <- matrix(unlist(results.this.setting), nrow = 3)
#Loop through the pairs of populations, and extract the information we need
for(this.row in 1:nrow(results.this.setting.for.figure)){
spearman.rank.vector <- c(spearman.rank.vector, results.this.setting.for.figure[this.row,3])
factor.A.vector <- c(factor.A.vector, factor.A)
factor.B.vector <- c(factor.B.vector, factor.B)
factor.C.vector <- c(factor.C.vector, factor.C)
factor.D.vector <- c(factor.D.vector, factor.D)
rep.vector <- c(rep.vector, this.rep)
pop.A.vector <-c(pop.A.vector, results.this.setting.for.figure[this.row,1])
pop.B.vector <- c(pop.B.vector, results.this.setting.for.figure[this.row,2])
}#End for(this.row in 1:nrow(results.this.setting.for.figure))
}#End for(rep in 1:3)
}#End for(el in 1:4)
data.for.boxplot <- data.frame(spearman.rank.vector, factor.A.vector,
factor.B.vector, factor.C.vector,
factor.D.vector, rep.vector,
pop.A.vector, pop.B.vector)
View(data.for.boxplot)
dim(data.for.boxplot)
data.for.boxplot <- data.frame(spearman.rank.vector, factor.A.vector,
factor.B.vector, factor.C.vector,
factor.D.vector, rep.vector,
pop.A.vector, pop.B.vector)
View(data.for.boxplot)
#Extract all of the results and put them into an object
spearman.rank.vector <- NULL
factor.A.vector <- NULL
factor.B.vector <- NULL
factor.C.vector <- NULL
factor.D.vector <- NULL
rep.vector <- NULL
pop.A.vector <- NULL
pop.B.vector <- NULL
i <- 1
j <- 0.05
k <- 0.05
for(k in c(0.05,0.5,1,2)){
for(el in c(0.05,0.5,1,2)){
for(rep in 1:3){
#Get the object from the list you want
factor.A <- i
factor.B <- j
factor.C <- k
factor.D <- el
this.rep <- rep
#Read in the R data file for a given setting
this.setting <-  paste(factor.A,".FactorA..",factor.B, ".FactorB..",
factor.C,".FactorC..",factor.D,".FactorD..",
this.rep, ".Rep", sep = "")
#Extract the results we want
results.this.setting <- these.spearman.rank.correlation.between.GWAS.core.QTNs[which(names(these.spearman.rank.correlation.between.GWAS.core.QTNs)
== this.setting)]
#Put the results into a format that we can extract the numbers from                                                                                                                                                                        == this.setting)]
results.this.setting.for.figure <- matrix(unlist(results.this.setting), nrow = 3)
#Loop through the pairs of populations, and extract the information we need
for(this.row in 1:nrow(results.this.setting.for.figure)){
spearman.rank.vector <- c(spearman.rank.vector, results.this.setting.for.figure[this.row,3])
factor.A.vector <- c(factor.A.vector, factor.A)
factor.B.vector <- c(factor.B.vector, factor.B)
factor.C.vector <- c(factor.C.vector, factor.C)
factor.D.vector <- c(factor.D.vector, factor.D)
rep.vector <- c(rep.vector, this.rep)
pop.A.vector <-c(pop.A.vector, results.this.setting.for.figure[this.row,1])
pop.B.vector <- c(pop.B.vector, results.this.setting.for.figure[this.row,2])
}#End for(this.row in 1:nrow(results.this.setting.for.figure))
}#End for(rep in 1:3)
}#End for(el in 1:4)
}#End for(k in 1:4)
data.for.boxplot <- data.frame(spearman.rank.vector, factor.A.vector,
factor.B.vector, factor.C.vector,
factor.D.vector, rep.vector,
pop.A.vector, pop.B.vector)
View(data.for.boxplot)
dim()data.for.boxplot)
dim(data.for.boxplot)
spearman.rank.vector <- NULL
factor.A.vector <- NULL
factor.B.vector <- NULL
factor.C.vector <- NULL
factor.D.vector <- NULL
rep.vector <- NULL
pop.A.vector <- NULL
pop.B.vector <- NULL
i <- 1
j <- 0.05
for(j in c(0.05,0.5,1,2)){
for(k in c(0.05,0.5,1,2)){
for(el in c(0.05,0.5,1,2)){
for(rep in 1:3){
#Get the object from the list you want
factor.A <- i
factor.B <- j
factor.C <- k
factor.D <- el
this.rep <- rep
#Read in the R data file for a given setting
this.setting <-  paste(factor.A,".FactorA..",factor.B, ".FactorB..",
factor.C,".FactorC..",factor.D,".FactorD..",
this.rep, ".Rep", sep = "")
#Extract the results we want
results.this.setting <- these.spearman.rank.correlation.between.GWAS.core.QTNs[which(names(these.spearman.rank.correlation.between.GWAS.core.QTNs)
== this.setting)]
#Put the results into a format that we can extract the numbers from                                                                                                                                                                        == this.setting)]
results.this.setting.for.figure <- matrix(unlist(results.this.setting), nrow = 3)
#Loop through the pairs of populations, and extract the information we need
for(this.row in 1:nrow(results.this.setting.for.figure)){
spearman.rank.vector <- c(spearman.rank.vector, results.this.setting.for.figure[this.row,3])
factor.A.vector <- c(factor.A.vector, factor.A)
factor.B.vector <- c(factor.B.vector, factor.B)
factor.C.vector <- c(factor.C.vector, factor.C)
factor.D.vector <- c(factor.D.vector, factor.D)
rep.vector <- c(rep.vector, this.rep)
pop.A.vector <-c(pop.A.vector, results.this.setting.for.figure[this.row,1])
pop.B.vector <- c(pop.B.vector, results.this.setting.for.figure[this.row,2])
}#End for(this.row in 1:nrow(results.this.setting.for.figure))
}#End for(rep in 1:3)
}#End for(el in 1:4)
}#End for(k in 1:4)
}#End for(j in 1:4)
data.for.boxplot <- data.frame(spearman.rank.vector, factor.A.vector,
factor.B.vector, factor.C.vector,
factor.D.vector, rep.vector,
pop.A.vector, pop.B.vector)
View(data.for.boxplot)
dim(data.for.boxplot)
#Extract all of the results and put them into an object
spearman.rank.vector <- NULL
factor.A.vector <- NULL
factor.B.vector <- NULL
factor.C.vector <- NULL
factor.D.vector <- NULL
rep.vector <- NULL
pop.A.vector <- NULL
pop.B.vector <- NULL
for(i in c(1,2,4)){
for(j in c(0.05,0.5,1,2)){
for(k in c(0.05,0.5,1,2)){
for(el in c(0.05,0.5,1,2)){
for(rep in 1:3){
#Get the object from the list you want
factor.A <- i
factor.B <- j
factor.C <- k
factor.D <- el
this.rep <- rep
#Read in the R data file for a given setting
this.setting <-  paste(factor.A,".FactorA..",factor.B, ".FactorB..",
factor.C,".FactorC..",factor.D,".FactorD..",
this.rep, ".Rep", sep = "")
#Extract the results we want
results.this.setting <- these.spearman.rank.correlation.between.GWAS.core.QTNs[which(names(these.spearman.rank.correlation.between.GWAS.core.QTNs)
== this.setting)]
#Put the results into a format that we can extract the numbers from                                                                                                                                                                        == this.setting)]
results.this.setting.for.figure <- matrix(unlist(results.this.setting), nrow = 3)
#Loop through the pairs of populations, and extract the information we need
for(this.row in 1:nrow(results.this.setting.for.figure)){
spearman.rank.vector <- c(spearman.rank.vector, results.this.setting.for.figure[this.row,3])
factor.A.vector <- c(factor.A.vector, factor.A)
factor.B.vector <- c(factor.B.vector, factor.B)
factor.C.vector <- c(factor.C.vector, factor.C)
factor.D.vector <- c(factor.D.vector, factor.D)
rep.vector <- c(rep.vector, this.rep)
pop.A.vector <-c(pop.A.vector, results.this.setting.for.figure[this.row,1])
pop.B.vector <- c(pop.B.vector, results.this.setting.for.figure[this.row,2])
}#End for(this.row in 1:nrow(results.this.setting.for.figure))
}#End for(rep in 1:3)
}#End for(el in 1:4)
}#End for(k in 1:4)
}#End for(j in 1:4)
}#End for(i in 1:3)
data.for.boxplot <- data.frame(spearman.rank.vector, factor.A.vector,
factor.B.vector, factor.C.vector,
factor.D.vector, rep.vector,
pop.A.vector, pop.B.vector)
View(data.for.boxplot)
dim(data.for.boxplot)
192*3
576*3
12145+5632+101500+47076
21619+8794
#Initiate the plot
par(mfrow = c(3,4))
View(data.for.boxplot)
choose(3,2)
#For loop through the pairs of three subpopulations
i <- 1
